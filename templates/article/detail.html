{% extends 'base.html' %}
{% load static %}
{% block stylesheet %}
    <title>{{object.title}}</title>
    <meta name="description" content="{{article.content}}">
    <link rel="stylesheet" href="{% static 'article/detail/detail.css' %}">
    <link rel="stylesheet" href="{% static 'common/detail/detail.css' %}">
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/monokai.min.css">-->
    <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
{% endblock stylesheet %}
{% block contents %}
<div id="container-box" class="container-fluid">
    <div id="row-box" class="row flex-column-reverse flex-md-row">
        <div class="col-12 col-md-8 col-xl-8" id="article-content">
            <nav id="article-breadcrumb" aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a class="link-hover-big" href="{% url 'article:list' %}">記事一覧</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{object.title}}</li>
                </ol>
            </nav>
            <h1 id="title" class="font-arial-MSGothic">{{object.title}}</h1>
            <div id="article-info-box" class="common-font">
                <p id="article-sub-info">
                    <span id="created-at" class="info badge bg-info text-white">作成日</span>{{object.created_at|date:"Y/m/d"}}
                    <span id="updated-at" class="info badge bg-info text-white">更新日</span>{{object.updated_at|date:"Y/m/d"}}
                    <span id="genre" class="info badge bg-info text-white">ジャンル</span>{{object.genre}}
                </p>
                <div id="article-property" class="d-flex">
                    <div class="pro">
                        <i class="fas fa-tags"></i>
                        {% for tag in tags %}
                            <span class="tags">{{tag}}</span>
                        {% endfor %}
                    </div>
                    <div class="pro">
                        <i class="far fa-eye"></i><span class="mgr-10"></span>{{object.views}}
                    </div>
                    <div class="pro">
                        <i class="fas fa-thumbs-up"></i><span class="mgr-10"></span>{{good_number}}
                    </div>
                </div>
            </div>
            <div id="user-info" class="d-flex">
                <a href="{% url 'profiles:otheruser_profile' profile.pk %}" class="align-self-center">
                    <img src="{{MEDIA_URL}}{{object.author.user.icon}}">
                </a>
                <div class="align-self-center">
                    <a href="{% url 'profiles:otheruser_profile' profile.pk %}" class="align-self-center">
                        <span class="common-font">{{object.author}}</span>
                    </a>
                </div>
            </div>
            <div id="good-box">
                {% if request.user.is_authenticated %}
                <div id="good-post">
                    <form method="POST" action="{% url 'article:good_count' %}">
                        {% csrf_token %}
                        <input type="hidden" name="good_count" value="{{object.pk}}"/>
                        <button type="submit" id="good-button"><i class="fas fa-thumbs-up"></i></button>
                    </form>
                </div>
                {% endif %}
            </div>
            <a href="https://px.a8.net/svt/ejp?a8mat=3NAEBR+1F7ASY+4X3U+5Z6WX" rel="nofollow">
            <img border="0" width="468" height="60" alt="" src="https://www21.a8.net/svt/bgt?aid=220514823086&wid=001&eno=01&mid=s00000022953001004000&mc=1"></a>
            <img border="0" width="1" height="1" src="https://www19.a8.net/0.gif?a8mat=3NAEBR+1F7ASY+4X3U+5Z6WX" alt="">
            <p id="expand-page">
                <a href={% url 'article:contents' object.pk %}>
                    <i class="fas fa-expand fa-2x"></i>
                </a>
            </p>
            <nav id="toc-nav" data-toggle="toc" class="navbar navbar-light flex-column common-font"><h2>見出し</h2></nav>
            <div id="article-content-box" class="content" data-bs-spy="scroll" data-bs-target="#toc-nav" data-bs-offset="10" data-bs-smooth-scroll="true" tabindex="0">
                <!--<link rel="stylesheet" href="{% static 'ckeditor/ckeditor/contents.css' %}">-->
                {{object.content|safe}}
            </div>
            <a href="https://px.a8.net/svt/ejp?a8mat=3NAEBR+3HMHF6+4PGA+BY641" rel="nofollow">
            <img border="0" width="936" height="120" alt="" src="https://www21.a8.net/svt/bgt?aid=220514823211&wid=001&eno=01&mid=s00000021961002007000&mc=1"></a>
            <img border="0" width="1" height="1" src="https://www17.a8.net/0.gif?a8mat=3NAEBR+3HMHF6+4PGA+BY641" alt="">
            <div id="sharing">
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
                <h5 class="font-arial-MSGothic">SNSでシェア</h5>
                <!-- Facebook -->
                <a class="js-sns-link" href="//www.facebook.com/sharer/sharer.php?u=&t=" target="_blank" rel="nofollow noopener noreferrer">
                    <img class="sns-icon" src="{% static 'images/sns/facebook/f_logo_RGB-Blue_144.png' %}"></img>
                </a>
                <!-- Twitter -->
                <a class="js-sns-link" href="//twitter.com/intent/tweet?text=&url=" target="_blank" rel="nofollow noopener noreferrer">
                    <img class="sns-icon" src="{% static 'images/sns/twitter/Twitter_social icons_circle_blue.png' %}">
                </a>
                <!-- LINE -->
                <a class="js-sns-link" href="//timeline.line.me/social-plugin/share?url=&text=" target="_blank" rel="nofollow noopener noreferrer">
                    <img class="sns-icon" src="{% static 'images/sns/line/LINE_Brand_icon.png' %}">
                </a>
                <!--
                <a class="js-sns-link" href="//b.hatena.ne.jp/add?mode=confirm&url=&title=" target="_blank" rel="nofollow noopener noreferrer">はてなブログ</a>
                <a class="js-sns-link" href="//www.pinterest.com/pin/create/button/?url=&media=" target="_blank" rel="nofollow noopener noreferrer">Pin it</a>
                -->
            </div>
        </div>
        <div class="col-12 col-md-4 col-xl-4" id="subcontents-box">
            <div id="table-of-contents">
            </div>
            <div id="new-articles" class="side-columns">
                {% include 'includes/article/_side_column/new.html' with articles=new_articles %}
            </div>
            <div id="relate-articles" class="side-columns">
                {% include 'includes/article/_side_column/relate.html' with articles=relate_articles %}
            </div>
        </div>
    </div>
</div>
{% include 'includes/common/comment.html' %}
{% endblock contents %}

{% block script %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="{% static 'article/detail/detail.js' %}"></script>
    <script>window.CKEDITOR_BASEPATH = "{% static '/ckeditor/ckeditor/' %}";</script>
    <script type="text/javascript" src="{% static 'ckeditor/ckeditor-init.js' %}" data-ckeditor-basepath="{% static 'ckeditor/ckeditor/' %}" id="ckeditor-init-script"></script>
    <script type="text/javascript" src="{% static 'ckeditor/ckeditor/ckeditor.js' %}"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script>
        let url = location.href
        let snsLinks=$(".js-sns-link")
        for(let i=0; i<snsLinks.length; i++){
            let href=snsLinks.eq(i).attr('href');
            //シェアページのURL上書き
            href=href.replace("u=","u="+url)     //facebook
            href=href.replace("url=","url="+url) //twitter,LINE,はてなブログ,ピンタレスト
            snsLinks.eq(i).attr('href',href);
        }
    </script>
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?skin=sons-of-obsidian"></script>
{% endblock script %}
